<div class="bg-white p-6 shadow rounded-lg">
  <h3 class="text-xl font-semibold mb-2">% Uso de Recursos</h3>
  <p class="text-sm text-gray-500 mb-4"><%= @server.server_status %></p>
  <canvas id="memChart" class="w-full h-64"></canvas>
  <div class="mt-4 flex space-x-4 text-sm">
    <span class="flex items-center"><span class="w-3 h-3 bg-yellow-500 inline-block mr-1"></span>% RAM</span>
    <span class="flex items-center"><span class="w-3 h-3 bg-green-500 inline-block mr-1"></span>% CPU</span>
  </div>
</div>
<script>
  document.addEventListener('turbo:load', function() {
    const ctx = document.getElementById('memChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: <%= raw @server_logs.first(100).pluck(:time).map { |time| time.strftime("%H:%M:%S") }.reverse %>,
        datasets: [
          {
            label: 'Memory Usage',
            data: <%= raw @server_logs.first(100).pluck(:memory_usage).reverse %>,
            borderColor: 'rgba(233, 180, 6, 1)',
            fill: false,
            pointStyle: false
          },
          {
            label: 'CPU Usage',
            data: <%= raw @server_logs.first(100).pluck(:cpu_usage).reverse %>,
            borderColor: 'rgba(33, 196, 94, 1)',
            fill: false,
            pointStyle: false
          },
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });
  })
</script>
